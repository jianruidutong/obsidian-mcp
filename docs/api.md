# ğŸ› ï¸ APIæ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†Enhanced Obsidian MCP Serveræä¾›çš„25ä¸ªAIå·¥å…·çš„APIæ¥å£ï¼ŒåŒ…æ‹¬å‚æ•°è¯´æ˜ã€è¿”å›å€¼æ ¼å¼å’Œä½¿ç”¨ç¤ºä¾‹ã€‚

## ğŸ“‹ ç›®å½•

1. [APIæ¦‚è¿°](#apiæ¦‚è¿°)
2. [æ ¸å¿ƒç¬”è®°ç®¡ç†å·¥å…· (10ä¸ª)](#æ ¸å¿ƒç¬”è®°ç®¡ç†å·¥å…·)
3. [æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ (3ä¸ª)](#æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ)
4. [æ¨¡æ¿ç³»ç»Ÿ (4ä¸ª)](#æ¨¡æ¿ç³»ç»Ÿ)
5. [AIå†…å®¹åˆ†æ (4ä¸ª)](#aiå†…å®¹åˆ†æ)
6. [çŸ¥è¯†å›¾è°±ä¸åˆ†æ (4ä¸ª)](#çŸ¥è¯†å›¾è°±ä¸åˆ†æ)
7. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## ğŸ” APIæ¦‚è¿°

### è°ƒç”¨æ–¹å¼
æ‰€æœ‰å·¥å…·é€šè¿‡Model Context Protocol (MCP)è°ƒç”¨ï¼Œæ”¯æŒJSON-RPC 2.0åè®®ã€‚

### é€šç”¨å“åº”æ ¼å¼
```json
{
  "content": [
    {
      "type": "text", 
      "text": "å“åº”å†…å®¹"
    }
  ]
}
```

### é”™è¯¯å“åº”æ ¼å¼
```json
{
  "error": {
    "code": -32000,
    "message": "é”™è¯¯æè¿°",
    "data": {
      "details": "è¯¦ç»†é”™è¯¯ä¿¡æ¯"
    }
  }
}
```

---

## ğŸ“š æ ¸å¿ƒç¬”è®°ç®¡ç†å·¥å…·

### 1. list_notes
åˆ—å‡ºçŸ¥è¯†åº“ä¸­çš„æ‰€æœ‰ç¬”è®°ï¼Œæ”¯æŒæ–‡ä»¶å¤¹è¿‡æ»¤ã€‚

**å‚æ•°**:
```json
{
  "folder": "string (å¯é€‰) - è¦è¿‡æ»¤çš„æ–‡ä»¶å¤¹è·¯å¾„"
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "æ‰¾åˆ° X ä¸ªç¬”è®°:\n\nğŸ“ folder1/\n  ğŸ“„ note1.md (1.2KB, ä¿®æ”¹äº: 2024-01-15)\n  ğŸ“„ note2.md (0.8KB, ä¿®æ”¹äº: 2024-01-14)\n\nğŸ“ folder2/\n  ğŸ“„ note3.md (2.1KB, ä¿®æ”¹äº: 2024-01-13)"
    }
  ]
}
```

**ç¤ºä¾‹è°ƒç”¨**:
```javascript
// åˆ—å‡ºæ‰€æœ‰ç¬”è®°
await mcp.callTool("list_notes", {});

// åˆ—å‡ºç‰¹å®šæ–‡ä»¶å¤¹çš„ç¬”è®°
await mcp.callTool("list_notes", {"folder": "Projects"});
```

### 2. read_note
è¯»å–å•ä¸ªç¬”è®°çš„å†…å®¹ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - ç¬”è®°çš„ç›¸å¯¹è·¯å¾„"
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text", 
      "text": "ğŸ“„ note.md\næ–‡ä»¶å¤§å°: 1.2KB\nä¿®æ”¹æ—¶é—´: 2024-01-15 10:30:00\n\n--- å†…å®¹ ---\n# ç¬”è®°æ ‡é¢˜\nç¬”è®°å†…å®¹..."
    }
  ]
}
```

### 3. read_multiple_notes
æ‰¹é‡è¯»å–å¤šä¸ªç¬”è®°çš„å†…å®¹ã€‚

**å‚æ•°**:
```json
{
  "paths": ["string"] // ç¬”è®°è·¯å¾„æ•°ç»„
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "æˆåŠŸè¯»å– 2 ä¸ªç¬”è®°:\n\n=== note1.md ===\nå†…å®¹1...\n\n=== note2.md ===\nå†…å®¹2..."
    }
  ]
}
```

### 4. create_note
åˆ›å»ºæ–°ç¬”è®°ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - æ–°ç¬”è®°çš„è·¯å¾„",
  "content": "string (å¿…éœ€) - ç¬”è®°å†…å®¹"
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "âœ… æˆåŠŸåˆ›å»ºç¬”è®°: path/to/note.md"
    }
  ]
}
```

### 5. update_note
æ›´æ–°ç¬”è®°å†…å®¹ï¼Œæ”¯æŒç²¾ç¡®å®šä½ç¼–è¾‘ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - ç¬”è®°è·¯å¾„",
  "dryRun": "boolean (å¯é€‰) - é¢„è§ˆæ¨¡å¼ï¼Œé»˜è®¤false",
  "edits": [
    {
      "mode": "replace|insert",
      "oldText": "string - è¦æ›¿æ¢çš„æ–‡æœ¬ (replaceæ¨¡å¼)",
      "newText": "string - æ–°æ–‡æœ¬ (replaceæ¨¡å¼)",
      "heading": "string - æ ‡é¢˜åç§° (insertæ¨¡å¼)",
      "content": "string - è¦æ’å…¥çš„å†…å®¹ (insertæ¨¡å¼)",
      "position": "before|after|append|prepend - æ’å…¥ä½ç½®"
    }
  ]
}
```

### 6. delete_note
åˆ é™¤æŒ‡å®šç¬”è®°ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - è¦åˆ é™¤çš„ç¬”è®°è·¯å¾„"
}
```

### 7. move_note
ç§»åŠ¨æˆ–é‡å‘½åç¬”è®°ã€‚

**å‚æ•°**:
```json
{
  "sourcePath": "string (å¿…éœ€) - æºè·¯å¾„",
  "destinationPath": "string (å¿…éœ€) - ç›®æ ‡è·¯å¾„"
}
```

### 8. manage_folder
ç®¡ç†æ–‡ä»¶å¤¹æ“ä½œã€‚

**å‚æ•°**:
```json
{
  "operation": "create|rename|move|delete",
  "path": "string (å¿…éœ€) - æ–‡ä»¶å¤¹è·¯å¾„",
  "newPath": "string (å¯é€‰) - æ–°è·¯å¾„ï¼Œç”¨äºrenameå’Œmoveæ“ä½œ"
}
```

### 9. search_vault
åœ¨æ•´ä¸ªçŸ¥è¯†åº“ä¸­æœç´¢å†…å®¹ã€‚

**å‚æ•°**:
```json
{
  "query": "string (å¿…éœ€) - æœç´¢å…³é”®è¯"
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ” æœç´¢ç»“æœ (æ‰¾åˆ° 3 ä¸ªåŒ¹é…é¡¹):\n\nğŸ“„ note1.md\nåŒ¹é…å†…å®¹: ...å…³é”®è¯...\n\nğŸ“„ note2.md\nåŒ¹é…å†…å®¹: ...å…³é”®è¯..."
    }
  ]
}
```

### 10. auto_backlink_vault
æ™ºèƒ½è‡ªåŠ¨é“¾æ¥ï¼Œæ£€æµ‹å¹¶åˆ›å»ºç¬”è®°é—´çš„é“¾æ¥ã€‚

**å‚æ•°**:
```json
{
  "dryRun": "boolean (å¯é€‰) - é¢„è§ˆæ¨¡å¼ï¼Œé»˜è®¤true",
  "minLength": "number (å¯é€‰) - æœ€å°ç¬”è®°åé•¿åº¦ï¼Œé»˜è®¤3", 
  "caseSensitive": "boolean (å¯é€‰) - å¤§å°å†™æ•æ„Ÿï¼Œé»˜è®¤false",
  "wholeWords": "boolean (å¯é€‰) - å…¨è¯åŒ¹é…ï¼Œé»˜è®¤true",
  "excludePatterns": "string[] (å¯é€‰) - æ’é™¤çš„æ–‡ä»¶æ¨¡å¼",
  "batchSize": "number (å¯é€‰) - æ‰¹å¤„ç†å¤§å°ï¼Œé»˜è®¤50"
}
```

---

## ğŸ·ï¸ æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ

### 1. add_tags
ä¸ºç¬”è®°æ·»åŠ æ ‡ç­¾ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - ç¬”è®°è·¯å¾„",
  "tags": "string[] (å¿…éœ€) - è¦æ·»åŠ çš„æ ‡ç­¾æ•°ç»„"
}
```

**ç¤ºä¾‹**:
```javascript
await mcp.callTool("add_tags", {
  "path": "Projects/Web Development.md",
  "tags": ["#web", "#javascript", "#project/active"]
});
```

### 2. list_tags
åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾åŠä½¿ç”¨ç»Ÿè®¡ã€‚

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ·ï¸ æ ‡ç­¾ç»Ÿè®¡ (å…± 15 ä¸ªæ ‡ç­¾):\n\n#web (ä½¿ç”¨ 5 æ¬¡)\n#javascript (ä½¿ç”¨ 3 æ¬¡)\n#project/active (ä½¿ç”¨ 8 æ¬¡)"
    }
  ]
}
```

### 3. search_by_tags
åŸºäºæ ‡ç­¾æœç´¢ç¬”è®°ã€‚

**å‚æ•°**:
```json
{
  "tags": "string[] (å¿…éœ€) - æ ‡ç­¾æ•°ç»„",
  "operator": "AND|OR (å¯é€‰) - é€»è¾‘æ“ä½œç¬¦ï¼Œé»˜è®¤AND"
}
```

---

## ğŸ“ æ¨¡æ¿ç³»ç»Ÿ

### 1. create_template
åˆ›å»ºå¯å¤ç”¨çš„ç¬”è®°æ¨¡æ¿ã€‚

**å‚æ•°**:
```json
{
  "name": "string (å¿…éœ€) - æ¨¡æ¿åç§°",
  "content": "string (å¿…éœ€) - æ¨¡æ¿å†…å®¹ï¼Œæ”¯æŒ{{å˜é‡}}",
  "description": "string (å¯é€‰) - æ¨¡æ¿æè¿°"
}
```

**æ¨¡æ¿å˜é‡ç¤ºä¾‹**:
```markdown
# {{title}}

åˆ›å»ºæ—¥æœŸ: {{date}}
ä½œè€…: {{author}}

## æ¦‚è¿°
{{summary}}

## è¯¦ç»†å†…å®¹
{{content}}
```

### 2. list_templates
åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ¨¡æ¿ã€‚

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ“ å¯ç”¨æ¨¡æ¿ (3 ä¸ª):\n\n1. meeting-notes\n   æè¿°: ä¼šè®®è®°å½•æ¨¡æ¿\n   å˜é‡: {{date}}, {{attendees}}, {{agenda}}\n\n2. project-template\n   æè¿°: é¡¹ç›®ç¬”è®°æ¨¡æ¿\n   å˜é‡: {{title}}, {{deadline}}, {{status}}"
    }
  ]
}
```

### 3. apply_template
åº”ç”¨æ¨¡æ¿åˆ›å»ºæ–°ç¬”è®°ã€‚

**å‚æ•°**:
```json
{
  "templateName": "string (å¿…éœ€) - æ¨¡æ¿åç§°",
  "outputPath": "string (å¿…éœ€) - è¾“å‡ºè·¯å¾„",
  "variables": {
    "title": "é¡¹ç›®åç§°",
    "date": "2024-01-15",
    "author": "å¼ ä¸‰"
  }
}
```

### 4. delete_template
åˆ é™¤ä¸éœ€è¦çš„æ¨¡æ¿ã€‚

**å‚æ•°**:
```json
{
  "name": "string (å¿…éœ€) - è¦åˆ é™¤çš„æ¨¡æ¿åç§°"
}
```

---

## ğŸ§  AIå†…å®¹åˆ†æ

### 1. extract_keywords
ä½¿ç”¨TF-IDFç®—æ³•æå–å…³é”®è¯ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - ç¬”è®°è·¯å¾„",
  "count": "number (å¯é€‰) - æå–æ•°é‡ï¼Œé»˜è®¤10"
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ”‘ å…³é”®è¯æå–ç»“æœ:\n\n1. æœºå™¨å­¦ä¹  (æƒé‡: 0.85)\n2. ç¥ç»ç½‘ç»œ (æƒé‡: 0.72)\n3. æ·±åº¦å­¦ä¹  (æƒé‡: 0.68)"
    }
  ]
}
```

### 2. generate_summary
ç”Ÿæˆå†…å®¹æ‘˜è¦ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - ç¬”è®°è·¯å¾„",
  "maxLength": "number (å¯é€‰) - æœ€å¤§æ‘˜è¦é•¿åº¦ï¼Œé»˜è®¤200"
}
```

### 3. suggest_tags
AIæ¨èç›¸å…³æ ‡ç­¾ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - ç¬”è®°è·¯å¾„",
  "count": "number (å¯é€‰) - æ¨èæ•°é‡ï¼Œé»˜è®¤5"
}
```

### 4. find_similar_notes
åŸºäºå†…å®¹ç›¸ä¼¼åº¦æŸ¥æ‰¾ç›¸å…³ç¬”è®°ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¿…éœ€) - å‚è€ƒç¬”è®°è·¯å¾„",
  "threshold": "number (å¯é€‰) - ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œé»˜è®¤0.3",
  "limit": "number (å¯é€‰) - ç»“æœæ•°é‡é™åˆ¶ï¼Œé»˜è®¤10"
}
```

---

## ğŸ“Š çŸ¥è¯†å›¾è°±ä¸åˆ†æ

### 1. analyze_note_relationships
åˆ†æç¬”è®°é—´çš„å…³ç³»ã€‚

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ“Š ç¬”è®°å…³ç³»åˆ†æ:\n\næ€»è®¡: 50 ä¸ªç¬”è®°, 120 ä¸ªè¿æ¥\n\nğŸ”— è¿æ¥æœ€å¤šçš„ç¬”è®°:\n1. æœºå™¨å­¦ä¹ åŸºç¡€.md (15 ä¸ªè¿æ¥)\n2. Pythonç¼–ç¨‹.md (12 ä¸ªè¿æ¥)\n\nğŸ“ˆ çŸ¥è¯†é›†ç¾¤:\n- ç¼–ç¨‹ç›¸å…³ (18 ä¸ªç¬”è®°)\n- æœºå™¨å­¦ä¹  (12 ä¸ªç¬”è®°)"
    }
  ]
}
```

### 2. generate_knowledge_graph
ç”ŸæˆçŸ¥è¯†å›¾è°±æ•°æ®ã€‚

**å‚æ•°**:
```json
{
  "format": "json|cytoscape (å¯é€‰) - è¾“å‡ºæ ¼å¼ï¼Œé»˜è®¤json",
  "includeOrphans": "boolean (å¯é€‰) - åŒ…å«å­¤ç«‹ç¬”è®°ï¼Œé»˜è®¤false"
}
```

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ“ˆ çŸ¥è¯†å›¾è°±æ•°æ® (JSONæ ¼å¼):\n\n{\n  \"nodes\": [\n    {\"id\": \"note1\", \"label\": \"æœºå™¨å­¦ä¹ \", \"size\": 10},\n    {\"id\": \"note2\", \"label\": \"æ·±åº¦å­¦ä¹ \", \"size\": 8}\n  ],\n  \"edges\": [\n    {\"source\": \"note1\", \"target\": \"note2\", \"weight\": 0.8}\n  ]\n}"
    }
  ]
}
```

### 3. find_orphan_notes
æŸ¥æ‰¾å­¤ç«‹ç¬”è®°ï¼ˆæ— é“¾æ¥çš„ç¬”è®°ï¼‰ã€‚

**è¿”å›å€¼**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "ğŸ” å­¤ç«‹ç¬”è®° (3 ä¸ª):\n\nğŸ“„ æœªåˆ†ç±»/éšæœºæƒ³æ³•.md\nğŸ“„ è‰ç¨¿/ä¸´æ—¶è®°å½•.md\nğŸ“„ archive/æ—§é¡¹ç›®.md\n\nğŸ’¡ å»ºè®®: è€ƒè™‘ä¸ºè¿™äº›ç¬”è®°æ·»åŠ ç›¸å…³é“¾æ¥æˆ–æ ‡ç­¾ã€‚"
    }
  ]
}
```

### 4. suggest_connections
AIæ¨èæ½œåœ¨çš„ç¬”è®°è¿æ¥ã€‚

**å‚æ•°**:
```json
{
  "path": "string (å¯é€‰) - ç‰¹å®šç¬”è®°è·¯å¾„",
  "threshold": "number (å¯é€‰) - ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œé»˜è®¤0.4",
  "limit": "number (å¯é€‰) - æ¨èæ•°é‡ï¼Œé»˜è®¤5"
}
```

---

## âŒ é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ä»£ç 

| é”™è¯¯ä»£ç  | é”™è¯¯ç±»å‹ | æè¿° |
|---------|----------|------|
| `-32000` | æœåŠ¡å™¨é”™è¯¯ | å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ |
| `-32001` | æ–‡ä»¶ä¸å­˜åœ¨ | è¯·æ±‚çš„ç¬”è®°æ–‡ä»¶ä¸å­˜åœ¨ |
| `-32002` | æƒé™é”™è¯¯ | æ— æ³•è®¿é—®æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ |
| `-32003` | éªŒè¯é”™è¯¯ | å‚æ•°éªŒè¯å¤±è´¥ |
| `-32004` | APIé”™è¯¯ | Obsidian APIè°ƒç”¨å¤±è´¥ |

### é”™è¯¯å¤„ç†ç¤ºä¾‹

```javascript
try {
  const result = await mcp.callTool("read_note", {"path": "nonexistent.md"});
} catch (error) {
  if (error.code === -32001) {
    console.log("æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è·¯å¾„");
  } else if (error.code === -32002) {
    console.log("æƒé™ä¸è¶³ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æƒé™");
  }
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–

**æ‰¹é‡æ“ä½œ**:
```javascript
// âœ… æ¨èï¼šä½¿ç”¨batchæ“ä½œ
await mcp.callTool("read_multiple_notes", {
  "paths": ["note1.md", "note2.md", "note3.md"]
});

// âŒ ä¸æ¨èï¼šå¤šæ¬¡å•ç‹¬è°ƒç”¨
await mcp.callTool("read_note", {"path": "note1.md"});
await mcp.callTool("read_note", {"path": "note2.md"});
await mcp.callTool("read_note", {"path": "note3.md"});
```

### 2. é”™è¯¯é¢„é˜²

**è·¯å¾„éªŒè¯**:
```javascript
// ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œé¿å…ç»å¯¹è·¯å¾„
const validPath = "Projects/Web Development.md";  // âœ…
const invalidPath = "/Users/name/vault/note.md"; // âŒ
```

### 3. å†…å®¹ç®¡ç†

**ä½¿ç”¨dry-runæ¨¡å¼**:
```javascript
// å…ˆé¢„è§ˆæ›´æ”¹
const preview = await mcp.callTool("update_note", {
  "path": "note.md",
  "dryRun": true,
  "edits": [...]
});

// ç¡®è®¤åæ‰§è¡Œ
const result = await mcp.callTool("update_note", {
  "path": "note.md", 
  "dryRun": false,
  "edits": [...]
});
```

### 4. æ¨¡æ¿ä½¿ç”¨

**å®šä¹‰æ¸…æ™°çš„å˜é‡å**:
```markdown
# âœ… æ¸…æ™°çš„å˜é‡å
# {{project_title}}
å¼€å§‹æ—¥æœŸ: {{start_date}}
è´Ÿè´£äºº: {{project_manager}}

# âŒ æ¨¡ç³Šçš„å˜é‡å
# {{title}}
æ—¥æœŸ: {{date}}
äººå‘˜: {{person}}
```

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [é…ç½®å‚è€ƒ](./configuration.md)
- [ä½¿ç”¨ç¤ºä¾‹](./examples.md)
- [å®‰è£…æŒ‡å—](../INSTALLATION.md)
- [é¡¹ç›®ä¸»é¡µ](https://github.com/jianruidutong/obsidian-mcp)